Module: M10-Notebook
Purpose: Create MTCR_Demo.ipynb notebook for live demo of MTCR Agentic Automation.

================================================================================
ðŸ”§ Cursor-ready prompt â€“ Create `MTCR_Demo.ipynb` demo notebook
================================================================================

Objective:

Create a Jupyter notebook `MTCR_Demo.ipynb` at the project root that:

1. Explains MTCR and the current process (Markdown + simple schematics).
2. Explains the agentic automation architecture I've built (M1â€“M10).
3. Runs a **live demo** of the pipeline using the existing code:
   * Tests LM Studio connectivity.
   * Runs the orchestrator demo on *N* rows.
   * Loads the resulting CSV into a DataFrame and displays it.
   * Shows a simple bar chart of AI_ReasonSuggestion distribution.

To support this, add small helper functions to existing modules so the notebook 
can call them programmatically without rewriting the logic.

================================================================================
Files edited / created:
================================================================================

**Edited:**
1. `src/utils/lmstudio_smoketest.py`
   - Added `test_lmstudio_connection()` function that wraps the existing 
     `test_lm_studio_connection()` and returns a bool for notebook use.
   - Kept existing CLI behavior intact.

2. `src/ai/orchestrator.py`
   - Added standalone `run_demo(sample_size: int = 10) -> dict` function
   - Returns dict with keys: rows_processed, avg_confidence, output_path, log_path
   - Wraps the existing MTCRDemoOrchestrator.run_demo() method.

**Created:**
3. `MTCR_Demo.ipynb` at the project root
   - Cell 1: Title and introduction (Markdown)
   - Cell 2: What is MTCR? (Markdown)
   - Cell 3: Current MTCR process schematic (Markdown)
   - Cell 4: Agentic automation architecture (Markdown)
   - Cell 5: Imports and setup (Python)
   - Cell 6: Test LM Studio connection (Python)
   - Cell 7: Run MTCR demo pipeline (Python)
   - Cell 8: Inspect demo output CSV (Python)
   - Cell 9: Visualize AI reason distribution (Python)
   - Cell 10: Roadmap and next steps (Markdown)

4. `docs/prompts/module-10-notebook.txt` â€“ this file

================================================================================
Implementation notes:
================================================================================

1. **lmstudio_smoketest.py changes:**
   - Added wrapper function `test_lmstudio_connection()` (no underscores)
   - Calls the existing `test_lm_studio_connection()` (with underscores)
   - Returns bool for easy notebook integration
   - CLI behavior preserved via main()

2. **orchestrator.py changes:**
   - Added standalone `run_demo()` function at module level
   - Instantiates MTCRDemoOrchestrator and calls its run_demo() method
   - Normalizes return dict keys (output_file â†’ output_path)
   - Existing CLI runner in src/run_mtcr_demo.py remains unchanged

3. **MTCR_Demo.ipynb structure:**
   - Markdown cells explain context and architecture
   - Python cells demonstrate live pipeline execution
   - Loads config, tests connection, runs demo, analyzes results
   - Visualizes AI reason suggestion distribution with matplotlib
   - Roadmap cell outlines what's implemented and what's needed next

4. **Compliance:**
   - No modifications to validated Excel files or macros
   - All AI outputs written to new CSV files (out/mtcr_ai_demo.csv)
   - Preserves existing behavior of CLI scripts
   - Assistive mode only - human review required

================================================================================
Usage:
================================================================================

To run the notebook:
1. Ensure LM Studio is running with a loaded model
2. Open MTCR_Demo.ipynb in Jupyter or VS Code
3. Run all cells sequentially
4. Review the generated visualizations and output

To use the updated helper functions from CLI (unchanged behavior):
```bash
# Test LM Studio connection
python src/utils/lmstudio_smoketest.py

# Run orchestrator demo
python src/run_mtcr_demo.py --n 10
```

================================================================================

